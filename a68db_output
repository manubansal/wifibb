setup_paths

ans =

../wifibb-traces/data

[samples,n_samples]=load_samples('~/farmshare/traces/54Mbps_1000b_600frames_-68dBm_seq.complex.1ch.float32','float32');

ans =

   1.0e-04 *

   0.0116 - 0.5884i
   0.1328 - 0.2894i
  -0.4808 + 0.3860i
  -0.9126 - 0.0166i
  -0.6616 + 0.1145i
   0.2539 - 0.0298i
  -0.1899 + 0.0110i
  -0.0982 + 0.2548i
  -0.2539 - 0.2642i
  -0.5068 - 0.2219i


n_samples =

     3000000

rx_sample_stream(samples)

DATA_DIR =

../wifibb-traces/data


TRACE_DIR =

../wifibb-traces


CDATA_DIR =

../wifibb-traces/cdata


BDATA_DIR =

../wifibb-traces/bdata


n_samples =

     3000000


confStr =

fromair.rate54


rx_pkts = 

     {}


opt = 

    trace: [1x1 struct]

trace folder:../wifibb-traces/traces-wifi-sbx-decim/

opt = 

                                             trace: [1x1 struct]
                                          tx_known: 0
                                         ti_factor: 32768
                               ti_factor_after_cfo: 65536
                 n_decoded_symbols_per_ofdm_symbol: 4
                             COARSE_CFO_CORRECTION: 1
                               FINE_CFO_CORRECTION: 1
                              PILOT_PHASE_TRACKING: 1
                   PILOT_SAMPLING_DELAY_CORRECTION: 1
                       GENERATE_ONE_TIME_PLOTS_PRE: 0
                      GENERATE_ONE_TIME_PLOTS_POST: 0
    GENERATE_PER_PACKET_PLOTS_ONLY_ON_FILTER_MATCH: 0
                         GENERATE_PER_PACKET_PLOTS: 0
           GENERATE_PER_PACKET_PLOTS_CONSTELLATION: 0
                 GENERATE_PER_PACKET_PLOTS_CHANNEL: 0
                          PAUSE_AFTER_EVERY_PACKET: 0
                                    writeVars_corr: 0
                               writeVars_startPnts: 0
                                    writeVars_cfos: 1
                            writeVars_deinterleave: 0
                              writeVars_depuncture: 0
                                  writeVars_decode: 0
                                    printVars_corr: 0
                                  printVars_chEsts: 0
                        printVars_cfoCorrectedPlcp: 0
                           printVars_ofdmDemodPlcp: 0
                       printVars_ofdmEqualizedPlcp: 0
                                printVars_equalize: 0
                           printVars_softBits_plcp: 0
                           printVars_softBits_data: 0
                            printVars_deinterleave: 0
                          printVars_softBits_deint: 0
                             printVars_decodedBits: 0
                         printVars_descrambledBits: 0
                               printVars_data_syms: 0
                             dumpVars_ltfRxSamples: 1
                          dumpVars_plcpBaseSamples: 1
                         dumpVars_plcpCfoCorrected: 1
                            dumpVars_plcpOfdmDemod: 1
                               dumpVars_plcpOfdmEq: 1
                                dumpVars_plcpDemap: 1
                          dumpVars_dataBaseSamples: 1
                         dumpVars_dataCfoCorrected: 1
                            dumpVars_dataOfdmDemod: 1
                               dumpVars_dataOfdmEq: 1
                                dumpVars_dataDemap: 1
                              dumpVars_dataDepunct: 1
                         dumpVars_dataVitdecChunks: 0
                               dumpVars_dataVitdec: 1
                                dumpVars_dataDescr: 1
                               dumpVars_dataParsed: 1
                                    corr_threshold: 0.7071
                                 sq_corr_threshold: 0.5000
                       ns_ofdm_phy_preamble_signal: 400
                              peak_search_win_size: 160
                                    max_nsyms_data: 501
                            max_pkt_length_samples: 40480
                                        ns_to_skip: 400000
                                     ns_to_process: 100000
                                           corrwin: 80
                                  soft_slice_nbits: 7
                                      tblen_signal: 18
                                        tblen_data: 18

tx and rx parameters of the experiment:

opt = 

                                             trace: {}
                                          tx_known: 0
                                         ti_factor: 32768
                               ti_factor_after_cfo: 65536
                 n_decoded_symbols_per_ofdm_symbol: 4
                             COARSE_CFO_CORRECTION: 1
                               FINE_CFO_CORRECTION: 1
                              PILOT_PHASE_TRACKING: 1
                   PILOT_SAMPLING_DELAY_CORRECTION: 1
                       GENERATE_ONE_TIME_PLOTS_PRE: 0
                      GENERATE_ONE_TIME_PLOTS_POST: 0
    GENERATE_PER_PACKET_PLOTS_ONLY_ON_FILTER_MATCH: 0
                         GENERATE_PER_PACKET_PLOTS: 0
           GENERATE_PER_PACKET_PLOTS_CONSTELLATION: 0
                 GENERATE_PER_PACKET_PLOTS_CHANNEL: 0
                          PAUSE_AFTER_EVERY_PACKET: 0
                                    writeVars_corr: 0
                               writeVars_startPnts: 0
                                    writeVars_cfos: 1
                            writeVars_deinterleave: 0
                              writeVars_depuncture: 0
                                  writeVars_decode: 0
                                    printVars_corr: 0
                                  printVars_chEsts: 0
                        printVars_cfoCorrectedPlcp: 0
                           printVars_ofdmDemodPlcp: 0
                       printVars_ofdmEqualizedPlcp: 0
                                printVars_equalize: 0
                           printVars_softBits_plcp: 0
                           printVars_softBits_data: 0
                            printVars_deinterleave: 0
                          printVars_softBits_deint: 0
                             printVars_decodedBits: 0
                         printVars_descrambledBits: 0
                               printVars_data_syms: 0
                             dumpVars_ltfRxSamples: 1
                          dumpVars_plcpBaseSamples: 1
                         dumpVars_plcpCfoCorrected: 1
                            dumpVars_plcpOfdmDemod: 1
                               dumpVars_plcpOfdmEq: 1
                                dumpVars_plcpDemap: 1
                          dumpVars_dataBaseSamples: 1
                         dumpVars_dataCfoCorrected: 1
                            dumpVars_dataOfdmDemod: 1
                               dumpVars_dataOfdmEq: 1
                                dumpVars_dataDemap: 1
                              dumpVars_dataDepunct: 1
                         dumpVars_dataVitdecChunks: 0
                               dumpVars_dataVitdec: 1
                                dumpVars_dataDescr: 1
                               dumpVars_dataParsed: 1
                                    corr_threshold: 0.7071
                                 sq_corr_threshold: 0.5000
                       ns_ofdm_phy_preamble_signal: 400
                              peak_search_win_size: 160
                                    max_nsyms_data: 501
                            max_pkt_length_samples: 40480
                                        ns_to_skip: 400000
                                     ns_to_process: 100000
                                           corrwin: 80
                                  soft_slice_nbits: 7
                                      tblen_signal: 18
                                        tblen_data: 18
                                     noise_win_len: 256
                                    noise_fft_size: 64
                                           stf_len: 160
                                           ltf_len: 160
                                           sig_len: 80
                                     stf_shift_len: 80
                                     ltf_shift_len: 64
                               sample_duration_sec: 5.0000e-08
                                         sym_len_s: 80
                                          cp_len_s: 16
                                          fft_size: 64
                                           cp_skip: 16
                                             ftype: [1x1 struct]


opt = 

                                             trace: {}
                                          tx_known: 0
                                         ti_factor: 32768
                               ti_factor_after_cfo: 65536
                 n_decoded_symbols_per_ofdm_symbol: 4
                             COARSE_CFO_CORRECTION: 1
                               FINE_CFO_CORRECTION: 1
                              PILOT_PHASE_TRACKING: 1
                   PILOT_SAMPLING_DELAY_CORRECTION: 1
                       GENERATE_ONE_TIME_PLOTS_PRE: 0
                      GENERATE_ONE_TIME_PLOTS_POST: 0
    GENERATE_PER_PACKET_PLOTS_ONLY_ON_FILTER_MATCH: 0
                         GENERATE_PER_PACKET_PLOTS: 0
           GENERATE_PER_PACKET_PLOTS_CONSTELLATION: 0
                 GENERATE_PER_PACKET_PLOTS_CHANNEL: 0
                          PAUSE_AFTER_EVERY_PACKET: 0
                                    writeVars_corr: 0
                               writeVars_startPnts: 0
                                    writeVars_cfos: 1
                            writeVars_deinterleave: 0
                              writeVars_depuncture: 0
                                  writeVars_decode: 0
                                    printVars_corr: 0
                                  printVars_chEsts: 0
                        printVars_cfoCorrectedPlcp: 0
                           printVars_ofdmDemodPlcp: 0
                       printVars_ofdmEqualizedPlcp: 0
                                printVars_equalize: 0
                           printVars_softBits_plcp: 0
                           printVars_softBits_data: 0
                            printVars_deinterleave: 0
                          printVars_softBits_deint: 0
                             printVars_decodedBits: 0
                         printVars_descrambledBits: 0
                               printVars_data_syms: 0
                             dumpVars_ltfRxSamples: 1
                          dumpVars_plcpBaseSamples: 1
                         dumpVars_plcpCfoCorrected: 1
                            dumpVars_plcpOfdmDemod: 1
                               dumpVars_plcpOfdmEq: 1
                                dumpVars_plcpDemap: 1
                          dumpVars_dataBaseSamples: 1
                         dumpVars_dataCfoCorrected: 1
                            dumpVars_dataOfdmDemod: 1
                               dumpVars_dataOfdmEq: 1
                                dumpVars_dataDemap: 1
                              dumpVars_dataDepunct: 1
                         dumpVars_dataVitdecChunks: 0
                               dumpVars_dataVitdec: 1
                                dumpVars_dataDescr: 1
                               dumpVars_dataParsed: 1
                                    corr_threshold: 0.7071
                                 sq_corr_threshold: 0.5000
                       ns_ofdm_phy_preamble_signal: 400
                              peak_search_win_size: 160
                                    max_nsyms_data: 501
                            max_pkt_length_samples: 40480
                                        ns_to_skip: 400000
                                     ns_to_process: 100000
                                           corrwin: 80
                                  soft_slice_nbits: 7
                                      tblen_signal: 18
                                        tblen_data: 18
                                     noise_win_len: 256
                                    noise_fft_size: 64
                                           stf_len: 160
                                           ltf_len: 160
                                           sig_len: 80
                                     stf_shift_len: 80
                                     ltf_shift_len: 64
                               sample_duration_sec: 5.0000e-08
                                         sym_len_s: 80
                                          cp_len_s: 16
                                          fft_size: 64
                                           cp_skip: 16
                                             ftype: [1x1 struct]


n_rx_samples =

     3000000

------------------- begin find_stream_correlation -------------------
------------------- done find_stream_correlation -------------------
Elapsed time is 1.472764 seconds.
start pkt processing?
-------------- scale:kk, packet #1-----------
-------------- last pkt took #0s to process ----
-------------- detecting next packet --------------

m =

    0.7154


i =

     5


pkt_start_point =

     1736111

maximum correlation value at any pkt start point:

max_corr_val =

    0.7154

-------------- analyzing next packet --------------
Got pkt at power-ratio estimated dB SNR = 0.80115
Dumping ltfRxSamples
Writing to ../wifibb-traces/bdata/fromair.rate54.ltfRxSamples.mdatDumping plcpBaseSamples
Writing to ../wifibb-traces/bdata/fromair.rate54.plcpBaseSamples.mdatDumping dataBaseSamples
Writing to ../wifibb-traces/bdata/fromair.rate54.dataBaseSamples.mdatstf based cfo estimation and correction
ltfs in time domain before any cfo
ltf based cfo estimation and correction
ltfs in time domain after all cfo correction
plcp signal field in time domain after all cfo correction

net_cfo_freq_off_khz =

    0.7437

Dumping plcpCfoCorrected
Writing to ../wifibb-traces/bdata/fromair.rate54.plcpCfoCorrected.mdatDumping dataCfoCorrected
Writing to ../wifibb-traces/bdata/fromair.rate54.dataCfoCorrected.mdat

avgsnr_cross_dB =

     0


ltf_avgsnr_dB =

    4.5889


ltf_avgsnr_dB_cross =

     0

Dumping ofdmDemodPlcp
Writing to ../wifibb-traces/bdata/fromair.rate54.plcpOfdmDemod.mdatpilot based phase tracking and compensation
pilot based sampling delay (due to sampling freq offset) correction
Dumping plcpOfdmEq.eqPnts
Writing to ../wifibb-traces/bdata/fromair.rate54.plcpOfdmEq.eqPnts.mdatDumping plcpOfdmEq.channeli
Writing to ../wifibb-traces/bdata/fromair.rate54.plcpOfdmEq.channeli.mdatDumping plcpOfdmEq.channel_dsubc
Writing to ../wifibb-traces/bdata/fromair.rate54.plcpOfdmEq.channel_dsubc.mdatDumping plcpOfdmEq.channel_psubc
Writing to ../wifibb-traces/bdata/fromair.rate54.plcpOfdmEq.channel_psubc.mdat
ltf_avgsnr_dB =

    4.5889


ltf_avgsnr_dB_cross =

     0

plotted plcp constellation, continue?
plcp signal field soft bits
Dumping plcpDemap
Writing to ../wifibb-traces/bdata/fromair.rate54.plcpDemap.mdat
valid =

     0

------------------------------------------------------------
parse signal results: 
rate:0 length:2783 code:0 parityCheck:1 valid:0 ndbps:0 nsyms:0
------------------------------------------------------------
------------------------------------------------------------
parse data results: 
frame_type (0: data, 1: ack, 2: unknown):-1 ber:-1 crcValid:-1
------------------------------------------------------------
signal field not valid, continuing without data decode...
frame_type: -1 crcValid: -1

last_pkt_start_point =

     1736111


max_corr_val =

    0.7154

Elapsed time is 3.552069 seconds.
-------------- scale:kk, packet #2-----------
-------------- last pkt took #3.5522s to process ----
-------------- detecting next packet --------------

m =

   Empty matrix: 1-by-0


i =

   Empty matrix: 1-by-0


pkt_start_point =

   Empty matrix: 1-by-0

no more packets detected
pkt_start_point is -Inf, breaking
displaying statistics:

inpl =

     1


mean_noise_power =

   1.9662e-09


std_noise_power =

     0

Note: The following avg snr values are meaningful only if the noise vector is fairly constant

avg_snr_lin =

    1.2026


avg_snr_db =

    0.8012


avg_ber =

    -1


pkt_start_points =

     1736111
        -Inf


min_chm_avg =

   Empty matrix: 0-by-1


max_chm_std =

   Empty matrix: 0-by-1


min_chm_avg =

   Empty matrix: 0-by-1


max_chm_std =

   Empty matrix: 0-by-1


avg_snr_data =

   NaN


avg_snr_ack =

   NaN

=============================================================================================
Aggregate performance stats: data:
n_crc_data/n_data_packets:0/0 ber_data_avg/ber_data_std:NaN/NaN
n_crc_ack/n_ack_packets:0/0 ber_ack_avg/ber_ack_std:NaN/NaN
n_unknown_packets:0
n_crc_unknown/n_unknown_packets:0/0 ber_unknown_avg/ber_unknown_std:NaN/NaN

crc_vec_data =

     []


crc_vec_ack =

     []


crc_vec_unknown =

     []

=============================================================================================

begin writeVars_cfos

outfilename =

../wifibb-traces/cdata/trace_skip_400000_ns_10000_cfo_khz.c

file written
end writeVars_cfos
diary off
